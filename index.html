<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online Call App</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <div id="app">
        <div id="login-screen" class="screen active">
            <div class="login-container">
                <h1>Online Call</h1>
                <p>Введите номер для создания или присоединения к звонку</p>
                <form id="room-form">
                    <input type="text" id="room-number" placeholder="Введите номер (до 14 цифр)" maxlength="14" pattern="\d{1,14}" required>
                    <button type="submit">Присоединиться</button>
                </form>
                <div id="error-message" class="error hidden"></div>
            </div>
        </div>

        <div id="waiting-screen" class="screen">
            <div class="waiting-container">
                <h2>Ожидание подключения</h2>
                <p>Номер комнаты: <span id="current-room"></span></p>
                <div class="loader"></div>
                <p>Поделитесь этим номером с другим пользователем</p>
                <button id="cancel-waiting">Отмена</button>
            </div>
        </div>

        <div id="call-screen" class="screen">
            <div class="call-container">
                <h2>Звонок активен</h2>
                <p>Номер комнаты: <span id="call-room"></span></p>
                
                <div class="video-container">
                    <div class="video-wrapper">
                        <video id="local-video" autoplay muted playsinline></video>
                        <div class="video-label">Вы</div>
                        <div class="volume-meter">
                            <div class="volume-level" style="height: 0%"></div>
                        </div>
                    </div>
                    <div class="video-wrapper">
                        <video id="remote-video" autoplay playsinline></video>
                        <div class="video-label">Собеседник</div>
                    </div>
                </div>
                
                <div class="call-controls">
                    <button id="mute-audio" class="control-btn">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 3.7v6.8l-2.5 2.5V6.7L5.5 3.7H12zm7.5 9.8c0 1.8-.7 3.5-2 4.7l-1.4-1.4c1-.9 1.6-2.1 1.6-3.3 0-1.3-.6-2.5-1.6-3.3l1.4-1.4c1.3 1.2 2 2.9 2 4.7zm-3.5 0c0 .8-.3 1.5-.9 2.1l-1.4-1.4c.3-.3.5-.7.5-1.1 0-.4-.2-.8-.5-1.1l1.4-1.4c.6.6.9 1.3.9 2.1z"/>
                        </svg>
                    </button>
                    <button id="mute-video" class="control-btn">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M15 8v8H5V8h10zm1-2H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4V7c0-.55-.45-1-1-1z"/>
                        </svg>
                    </button>
                    <button id="switch-camera" class="control-btn" style="display: none;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 12c1.65 0 3-1.35 3-3s-1.35-3-3-3-3 1.35-3 3 1.35 3 3 3zm0-4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm6 8.58c0-2.5-3.97-3.58-6-3.58s-6 1.08-6 3.58V18h12v-1.42zM8.48 16c.74-.51 2.23-1 3.52-1s2.78.49 3.52 1H8.48z"/>
                        </svg>
                    </button>
                    <button id="end-call" class="control-btn end-call">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 9c-1.6 0-3.15.25-4.6.72v3.1c0 .39-.23.74-.56.9-.98.49-1.87 1.12-2.66 1.85-.18.18-.43.28-.7.28-.28 0-.53-.11-.71-.29L.29 13.08c-.18-.17-.29-.42-.29-.7 0-.28.11-.53.29-.71C3.34 8.78 7.46 7 12 7s8.66 1.78 11.71 4.67c.18.18.29.43.29.71 0 .28-.11.53-.29.71l-2.48 2.48c-.18.18-.43.29-.71.29-.27 0-.52-.11-.7-.28a11.27 11.27 0 0 0-2.67-1.85.996.996 0 0 1-.56-.9v-3.1C15.15 9.25 13.6 9 12 9z"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
